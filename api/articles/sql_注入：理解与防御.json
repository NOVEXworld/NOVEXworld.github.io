{"title":"SQL 注入：理解与防御","uid":"3eabff52a59ec3f2a0de93140ccc852c","slug":"sql_注入：理解与防御","date":"2025-05-10T20:44:27.000Z","updated":"2025-05-11T04:47:25.899Z","comments":true,"path":"api/articles/sql_注入：理解与防御.json","keywords":null,"cover":null,"content":"<h1 id=\"SQL-注入：理解与防御\"><a href=\"#SQL-注入：理解与防御\" class=\"headerlink\" title=\"SQL 注入：理解与防御\"></a>SQL 注入：理解与防御</h1><p>SQL 注入是最常见也是最危险的 Web 安全漏洞之一。当恶意用户通过输入字段操控 SQL 查询时，可能会导致未授权访问数据库的情况。本文将解释什么是 SQL 注入，并提供防御措施。</p>\n<h2 id=\"什么是-SQL-注入？\"><a href=\"#什么是-SQL-注入？\" class=\"headerlink\" title=\"什么是 SQL 注入？\"></a>什么是 SQL 注入？</h2><p>SQL 注入攻击通过操控 SQL 查询的结构，使得攻击者能够访问、修改或删除数据库中的数据。</p>\n<h3 id=\"SQL-注入攻击示例\"><a href=\"#SQL-注入攻击示例\" class=\"headerlink\" title=\"SQL 注入攻击示例\"></a>SQL 注入攻击示例</h3><p>考虑以下易受攻击的查询：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> users <span class=\"keyword\">WHERE</span> username <span class=\"operator\">=</span> <span class=\"string\">&#x27;user_input&#x27;</span> <span class=\"keyword\">AND</span> password <span class=\"operator\">=</span> <span class=\"string\">&#x27;password_input&#x27;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>如果攻击者输入 <code>&#39; OR 1=1 --</code>，查询就变成了：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> users <span class=\"keyword\">WHERE</span> username <span class=\"operator\">=</span> <span class=\"string\">&#x27;&#x27;</span> <span class=\"keyword\">OR</span> <span class=\"number\">1</span><span class=\"operator\">=</span><span class=\"number\">1</span> <span class=\"comment\">-- AND password = &#x27;password_input&#x27;;</span></span><br></pre></td></tr></table></figure>\n\n<p>这个查询将始终返回真，从而使攻击者成功绕过认证。</p>\n<h2 id=\"如何防止-SQL-注入？\"><a href=\"#如何防止-SQL-注入？\" class=\"headerlink\" title=\"如何防止 SQL 注入？\"></a>如何防止 SQL 注入？</h2><ul>\n<li><strong>使用预处理语句</strong>：预处理语句将 SQL 代码与数据分开，避免了注入攻击。</li>\n<li><strong>验证和清理用户输入</strong>：始终检查和清理用户输入，确保其符合预期格式。</li>\n<li><strong>使用 ORM 库</strong>：如 SQLAlchemy 等 ORM 库自动处理输入清理，减少 SQL 注入的风险。</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 使用 Python 的 SQLite 和参数化查询的示例</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sqlite3</span><br><span class=\"line\"></span><br><span class=\"line\">conn = sqlite3.connect(<span class=\"string\">&#x27;database.db&#x27;</span>)</span><br><span class=\"line\">cursor = conn.cursor()</span><br><span class=\"line\"></span><br><span class=\"line\">username = <span class=\"built_in\">input</span>(<span class=\"string\">&#x27;请输入用户名: &#x27;</span>)</span><br><span class=\"line\">password = <span class=\"built_in\">input</span>(<span class=\"string\">&#x27;请输入密码: &#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">cursor.execute(<span class=\"string\">&quot;SELECT * FROM users WHERE username = ? AND password = ?&quot;</span>, (username, password))</span><br><span class=\"line\">user = cursor.fetchone()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> user:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;登录成功&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;用户名或密码错误&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h2><p>防止 SQL 注入是 Web 应用安全的关键。通过使用预处理语句、清理输入和 ORM 库，你可以大大降低 SQL 注入攻击的风险。</p>\n","text":"SQL 注入：理解与防御SQL 注入是最常见也是最危险的 Web 安全漏洞之一。当恶意用户通过输入字段操控 SQL 查询时，可能会导致未授权访问数据库的情况。本...","permalink":"/post/sql_注入：理解与防御","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#SQL-%E6%B3%A8%E5%85%A5%EF%BC%9A%E7%90%86%E8%A7%A3%E4%B8%8E%E9%98%B2%E5%BE%A1\"><span class=\"toc-text\">SQL 注入：理解与防御</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%80%E4%B9%88%E6%98%AF-SQL-%E6%B3%A8%E5%85%A5%EF%BC%9F\"><span class=\"toc-text\">什么是 SQL 注入？</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#SQL-%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E7%A4%BA%E4%BE%8B\"><span class=\"toc-text\">SQL 注入攻击示例</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2-SQL-%E6%B3%A8%E5%85%A5%EF%BC%9F\"><span class=\"toc-text\">如何防止 SQL 注入？</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BB%93%E8%AE%BA\"><span class=\"toc-text\">结论</span></a></li></ol></li></ol>","author":{"name":"NOVEX","slug":"blog-author","avatar":"https://i.postimg.cc/rmCw5fJd/Chat-GPT-Image-2025-5-11-11-16-20.png","link":"/","description":"诺维茨 <br /><b>人工智能计算领域的领导者|NOVEX</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"RESTful API 与 Web 开发入门","uid":"3e207f6fa528d67195c58205a95be87b","slug":"restful_api_与_web_开发入门","date":"2025-05-10T20:44:27.000Z","updated":"2025-05-11T04:47:29.468Z","comments":true,"path":"api/articles/restful_api_与_web_开发入门.json","keywords":null,"cover":null,"text":"RESTful API 与 Web 开发入门表现层状态转移（REST）是现代 Web 开发中常用的设计模式。RESTful API 使客户端和服务器之间的通信变...","permalink":"/post/restful_api_与_web_开发入门","photos":[],"count_time":{"symbolsCount":721,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"NOVEX","slug":"blog-author","avatar":"https://i.postimg.cc/rmCw5fJd/Chat-GPT-Image-2025-5-11-11-16-20.png","link":"/","description":"诺维茨 <br /><b>人工智能计算领域的领导者|NOVEX</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"机器学习基础：初学者指南","uid":"7d58378d7bed8b8e59b633a973c41fd2","slug":"机器学习基础：初学者指南","date":"2025-05-10T20:44:27.000Z","updated":"2025-05-11T04:47:33.445Z","comments":true,"path":"api/articles/机器学习基础：初学者指南.json","keywords":null,"cover":null,"text":"机器学习基础：初学者指南机器学习（ML）是人工智能（AI）的一个子集，使得系统能够从经验中学习和改进，而不需要显式编程。本文将介绍机器学习的基本概念，并通过 P...","permalink":"/post/机器学习基础：初学者指南","photos":[],"count_time":{"symbolsCount":897,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"NOVEX","slug":"blog-author","avatar":"https://i.postimg.cc/rmCw5fJd/Chat-GPT-Image-2025-5-11-11-16-20.png","link":"/","description":"诺维茨 <br /><b>人工智能计算领域的领导者|NOVEX</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}